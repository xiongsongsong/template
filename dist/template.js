define("template/template/1.0.0/template",["./split","./json2"],function(require,exports,module){"use strict";function temporaryProtection(e){for(var t=0;placeholderFlag.length>t;t++){var r=placeholderFlag[t];e=e.replace(r[0],r[1].source)}return e=e.replace(/#js([\s\S]*?)#end/gm,"AMS_FLAG_JS$1AMS_FLAG_ENDJS")}function revertProtection(e){for(var t=0;placeholderFlag.length>t;t++){var r=placeholderFlag[t];e=e.replace(r[1],r[2])}return e}function replaceElse(e){return e=e.replace(/#(elseif)[\s]*(\([^)]+\)){1}/gm,"AMS_FLAG_ELSEIF$2"),e=e.replace(/#else/gm,"AMS_FLAG_ELSE"),e=e.replace(/AMSTEMPBLOCKS==(.*)==/gm,"\\#$1")}function translateIF(e){function t(){if(/#end/.test(e)){var r=e.match(/[\s\S]+?#end/)[0],_="";if(/#(if|each|js)/gm.test(r)){for(var A=[],o=0;n.length>o;o++){var s=n[o],p=r.lastIndexOf(s);p>-1&&A.push(p)}r=r.substring(Math.max.apply(null,A));var S=r.match(l),i=S[0].substring(1),c="",u="";"if"==i?(c="AMS_FLAG_IF",u="AMS_FLAG_ENDIF"):"each"==i?(c="AMS_FLAG_EACH",u="AMS_FLAG_ENDEACH"):"js"==i&&(c="AMS_FLAG_JS",u="AMS_FLAG_ENDJS"),_=r.replace(a,c+"$1"+u),"if"===i&&(_=replaceElse(_)),e=e.replace(r,_)}else _=r.substring(0,r.length-4),e=e.replace(r,_);t()}}function r(t){var r=/[\\]+#\{([^}]+)\}/gm;e=t.replace(r,"AMS_VARIABLE_COMMENT$1}"),e=e.replace(/#\{([^}]+)\}/gm,"AMS_PLACEHOLDER_START--$1--AMS_PLACEHOLDER_END")}e=temporaryProtection(e);var n=["#if","#each","#js"],l=/#(if|each|js)/gm,a=/(?:#if|#each|#js)([\s\S]+?)#end/gm;return t(),r(e),e}function transportOperation(e){var t=/(AMS_FLAG_IF|AMS_FLAG_ELSEIF){1}(?:[\s]*([^)]+?\)))(.*?)(?=AMS_FLAG_ELSEIF|AMS_FLAG_ELSE|AMS_FLAG_ENDIF|AMS_FLAG_EACH|AMS_FLAG_JS|[\r\n])/gm;return e=e.replace(t,"$1AMS_OPERATION--$2--AMS_OPERATION$3")}function transportJS(e){var t=/AMS_FLAG_JS(?:[\s\S]+?)AMS_FLAG_ENDJS/gm,r=e.match(t);if(r)for(var n=0;r.length>n;n++){var l=r[n],a=l.match(/AMS_FLAG_JS([\s\S]+?)AMS_FLAG_ENDJS/);a&&(e=e.replace(l,"AMS_FLAG_JS"+encodeURIComponent(a[1])+"AMS_FLAG_ENDJS"))}return e}function transportVar(e){return e=e.replace(/^[\s]*#run(.+?)$/gm,"AMS_RUN_START$1AMS_RUN_END")}function render(value,AMS_DATA){var tpl,html,head='var AMS_RENDER=" ";\r\n;function echo(s){AMS_RENDER+=s;}\r\n';for(var k in AMS_DATA)AMS_DATA.hasOwnProperty(k)&&(head+="var "+k+" = AMS_DATA."+k+";\r\n");var _tpl;html=" ",tpl=translateIF(value),tpl=transportJS(tpl),tpl=transportOperation(tpl),tpl=transportVar(tpl),tpl=revertProtection(tpl),_tpl=tpl.split(/[\r\n]/);for(var l=0;_tpl.length>l;l++){for(var str=_tpl[l],arr=split(str,IF_FLAG),i=0;arr.length>i;i++){var _str=arr[i];IF_FLAG.test(_str)?/AMS_FLAG_IFAMS_OPERATION/.test(_str)?html+=_str.replace(/AMS_FLAG_IFAMS_OPERATION--(.+?)--AMS_OPERATION/g,"if $1 {"):/AMS_FLAG_ELSEIFAMS_OPERATION/.test(_str)?html+=_str.replace(/AMS_FLAG_ELSEIFAMS_OPERATION--(.+?)--AMS_OPERATION/,"} else if $1 { "):"AMS_FLAG_ELSE"===_str?html+=_str.replace(/AMS_FLAG_ELSE/,"} else {"):"AMS_FLAG_ENDIF"===_str?html+=_str.replace(/AMS_FLAG_ENDIF/gm,"}"):/AMS_FLAG_EACH/.test(_str)?html+=_str.replace(forEachRe,function(e){var t=e.match(forEachRe),r=t[1].split(","),n=t[2],l=r.length>1?r[1]:"index"+AMS_Index++,a=r[2]?r[2]:n;return""+(r[2]?"var "+r[2]+"="+n+";":"")+"\r\n"+"for(var "+l+"=0;"+l+"<"+a+".length;"+l+"++){\r\n"+"var "+r[0]+"="+a+"["+l+"];\r\n"}):"AMS_FLAG_ENDEACH"===_str?html+=_str.replace(/AMS_FLAG_ENDEACH/gm,"};"):/AMS_PLACEHOLDER_START/.test(_str)?html+=_str.replace(/AMS_PLACEHOLDER_START--(.+?)--AMS_PLACEHOLDER_END/,"echo($1);"):/AMS_FLAG_JS/.test(_str)?(_str.match(/AMS_FLAG_JS(.+?)AMS_FLAG_ENDJS/),html+=_str.replace(/AMS_FLAG_JS(.+?)AMS_FLAG_ENDJS/,decodeURIComponent(_str.match(/AMS_FLAG_JS(.+?)AMS_FLAG_ENDJS/)[1])+"\r\n")):/AMS_RUN_START/.test(_str)&&(html+=_str.replace(/AMS_RUN_START(.+?)AMS_RUN_END/,"$1")):_str.length>0&&(html+='AMS_RENDER+="'+_str.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'";'),_str.length>0&&(html+="\r\n"),i===arr.length-1&&(html+='AMS_RENDER+="\\r\\n";')}html+="\r\n"}return console.log(head+html),eval(head+html)}var split=require("./split").split,JSON=require("./json2").JSON,AMS_Index=0,placeholderFlag=[[/\\#if/gm,/AMS_IF_COMMENT/gm,"#if"],[/\\#elseif/gm,/AMS_ELSEIF_COMMENT/gm,"#elseif"],[/\\#else/gm,/AMS_ELSE_COMMENT/gm,"#else"],[/\\#each/gm,/AMS_EACH_COMMENT/gm,"#each"],[/\\#end/gm,/AMS_END_COMMENT/gm,"#end"],[/\\#run/gm,/AMS_RUN_COMMENT/gm,"#run"],[/\\#js/gm,/AMS_JS_COMMENT/gm,"#js"],[/\\#\{/,/AMS_VARIABLE_COMMENT/,"#{"],[/\$/gim,/AMS_RE/gm,"$"],[/\\\)/gim,/AMS_CLOSE/gm,")"]],OPEN_IF=["AMS_FLAG_IFAMS_OPERATION","AMS_FLAG_ELSEIFAMS_OPERATION"],CLOSE_IF="AMS_OPERATION",IF_FLAG=RegExp("("+OPEN_IF[0]+"--(?:.+?)--"+CLOSE_IF+"|"+OPEN_IF[1]+"--(?:.+?)--"+CLOSE_IF+"|"+"AMS_FLAG_EACH(?:\\([^)]+?\\))|"+"AMS_PLACEHOLDER_START"+"--(?:.+?)--"+"AMS_PLACEHOLDER_END|"+"AMS_FLAG_JS(?:.+?)AMS_FLAG_ENDJS|"+"AMS_RUN_START(?:.+?)AMS_RUN_END|"+"AMS_FLAG_ELSE|AMS_FLAG_ENDIF|AMS_FLAG_ENDEACH)","gm"),forEachRe=/AMS_FLAG_EACH\((.+?)[\s]+in[\s]+([^\s]+)\)/;module.exports?module.exports=render:window.template=template}),define("template/template/1.0.0/split",[],function(e,t){var r;r=r||function(e){var t,r=String.prototype.split,n=/()??/.exec("")[1]===e;return t=function(t,l,a){if("[object RegExp]"!==Object.prototype.toString.call(l))return r.call(t,l,a);var _,A,o,s,p=[],S=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.extended?"x":"")+(l.sticky?"y":""),i=0,l=RegExp(l.source,S+"g");for(t+="",n||(_=RegExp("^"+l.source+"$(?!\\s)",S)),a=a===e?-1>>>0:a>>>0;(A=l.exec(t))&&(o=A.index+A[0].length,!(o>i&&(p.push(t.slice(i,A.index)),!n&&A.length>1&&A[0].replace(_,function(){for(var t=1;arguments.length-2>t;t++)arguments[t]===e&&(A[t]=e)}),A.length>1&&A.index<t.length&&Array.prototype.push.apply(p,A.slice(1)),s=A[0].length,i=o,p.length>=a)));)l.lastIndex===A.index&&l.lastIndex++;return i===t.length?s||!l.test(""):p.push(t.slice(i)),p.length>a?p.slice(0,a):p},String.prototype.split=function(e,r){return t(this,e,r)},t}(),t.split=r}),define("template/template/1.0.0/json2",[],function(require,exports,module){"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var r,n,l,a,_,A=gap,o=t[e];switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(e)),"function"==typeof rep&&(o=rep.call(t,e,o)),typeof o){case"string":return quote(o);case"number":return isFinite(o)?o+"":"null";case"boolean":case"null":return o+"";case"object":if(!o)return"null";if(gap+=indent,_=[],"[object Array]"===Object.prototype.toString.apply(o)){for(a=o.length,r=0;a>r;r+=1)_[r]=str(r,o)||"null";return l=0===_.length?"[]":gap?"[\n"+gap+_.join(",\n"+gap)+"\n"+A+"]":"["+_.join(",")+"]",gap=A,l}if(rep&&"object"==typeof rep)for(a=rep.length,r=0;a>r;r+=1)"string"==typeof rep[r]&&(n=rep[r],l=str(n,o),l&&_.push(quote(n)+(gap?": ":":")+l));else for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(l=str(n,o),l&&_.push(quote(n)+(gap?": ":":")+l));return l=0===_.length?"{}":gap?"{\n"+gap+_.join(",\n"+gap)+"\n"+A+"}":"{"+_.join(",")+"}",gap=A,l}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,r){var n;if(gap="",indent="","number"==typeof r)for(n=0;r>n;n+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var r,n,l=e[t];if(l&&"object"==typeof l)for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(n=walk(l,r),void 0!==n?l[r]=n:delete l[r]);return reviver.call(e,t,l)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),exports.JSON=JSON});
